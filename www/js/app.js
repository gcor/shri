!function(t){function e(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return t[n].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){i(1),i(8),i(3),i(6),i(4),i(2),i(7),t.exports=i(5)},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(2),l=(n(s),i(4)),o=n(l),d=i(6),u=n(d),c=function(){function t(e){a(this,t),this.store=e,this.$header=document.querySelector(".alarm__header"),this.$body=document.querySelector(".alarm__body"),this.$signals=null,this.initSignals(),this.initQuickAdd()}return r(t,[{key:"initQuickAdd",value:function(t){var e=document.createElement("div"),i=new u["default"](this);e.className="alarm__add",e.appendChild(i.render()),this.$header.appendChild(e)}},{key:"initSignals",value:function(){var t=this,e=document.createElement("div");e.className="alarm__signals",this.$signals=e;this.store.getAll(function(i){i.map(function(e){t.renderSignal(e)}),t.$body.appendChild(e)})}},{key:"add",value:function(t,e){var i=this;this.store.add(t,e,function(t){i.renderSignal(t,{open:!0})})}},{key:"renderSignal",value:function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=new o["default"](this.store,t);this.$signals.insertBefore(i.render(e),this.$signals.firstChild)}}]),t}();e["default"]=c},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(3),l=n(s),o=function(){function t(e){a(this,t);var i=window.indexedDB.open("alarmDatabase57");this.db=null,this.notify=new l["default"],this.initCallback=e,i.addEventListener("upgradeneeded",t.onUpgradeneeded.bind(this)),i.addEventListener("success",t.onSuccess.bind(this)),i.addEventListener("error",t.onError.bind(this))}return r(t,[{key:"getAll",value:function(t){var e=this.db.transaction("signals").objectStore("signals").getAll();e.onsuccess=function(e){t&&t(e.target.result)},e.onerror=function(t){return console.log("Failed",t)}}},{key:"set",value:function(e){var i=this;e.active?e.repeat.length?e.repeat.forEach(function(n,a){i.notify.update({id:e.id+"."+a,every:"week",at:t.getWeekTime(n,e.hour,e.minute)})}):this.notify.update({id:e.id,at:t.getOnceTime(e.hour,e.minute)}):this.notify.clear(e.id);var n=this.db.transaction("signals","readwrite").objectStore("signals").put(e);n.onerror=function(t){return console.log("Failed",t)}}},{key:"add",value:function(e,i,n){var a=this,r={active:!1,hour:e,minute:i,repeat:[]},s=this.db.transaction("signals","readwrite").objectStore("signals").add(r);s.onsuccess=function(s){var l=s.target.result;r.id=l,a.notify.add({id:l,at:t.getOnceTime(e,i)}),n&&n(r)},s.onerror=function(t){return console.log("Failed",t)}}},{key:"remove",value:function(t){var e=this.db.transaction("signals","readwrite").objectStore("signals")["delete"](t);this.notify.clear(t),e.onerror=function(t){return console.log("Failed",t)}}}],[{key:"onUpgradeneeded",value:function(t){this.db=t.target.result,this.db.createObjectStore("signals",{autoIncrement:!0,keyPath:"id"})}},{key:"onSuccess",value:function(t){this.db=t.target.result,this.initCallback()}},{key:"onError",value:function(){console.log("Failed")}},{key:"getOnceTime",value:function(t,e){var i=new Date,n=new Date(i.getFullYear(),i.getMonth(),i.getDate(),t,e),a=864e5;return i.getTime()>n.getTime()&&(n=n.getTime()+a),new Date(n)}},{key:"getWeekTime",value:function(t,e,i){var n=new Date,a=new Date(n.getFullYear(),n.getMonth(),n.getDate(),e,i),r=864e5;return a.setDate(a.getDate()-a.getDay()+parseInt(t)),n.getTime()>a.getTime()&&(a=a.getTime()+7*r),new Date(a)}}]),t}();e["default"]=o},function(t,e){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function(){function t(){i(this,t),this.notify=cordova.plugins.notification.local}return n(t,[{key:"getFullConfig",value:function(t){return t.title="Alarm",t.text="wake up!",t.sound="../media/sound.mp3",t}},{key:"add",value:function(t){this.getFullConfig(t);this.notify.schedule(t)}},{key:"update",value:function(t){this.getFullConfig(t);this.notify.update(t)}},{key:"clear",value:function(t){this.notify.clear(t)}}]),t}();e["default"]=a},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function a(t){return t&&t.__esModule?t:{"default":t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=i(2),o=(a(l),i(5)),d=n(o),u=function(){function t(e,i){r(this,t);var n=document.createElement("div");n.className="signal",this.isEdit=!1,this.isActive=!1,this.isRepeat=!1,this.currentInputTime=[],this.currentInputEditPosition=null,this.currentChar=null,this.template=d.str,this.store=e,this.id=i.id,this.model={id:i.id,active:i.active,repeat:i.repeat,hour:i.hour,minute:i.minute,weekDays:["Mn","Ts","Wd","Th","Fr","St","Sn"]},n.innerHTML=this.template(this.model),this.$el=n,this.initialize()}return s(t,[{key:"initialize",value:function(){this.$keyboardNum=this.$el.querySelectorAll(".keyboard__num"),this.$signalChar=this.$el.querySelectorAll(".signal__char"),this.$signalTime=this.$el.querySelector(".signal__time"),this.$signalDescription=this.$el.querySelector(".signal__description"),this.$signalDescBlock=this.$el.querySelector(".signal__cell_type_description"),this.$signalDelete=this.$el.querySelector(".signal__cell_type_delete"),this.$signalSwitcher=this.$el.querySelector(".signal__cell_type_switcher"),this.$repeatSwitcher=this.$el.querySelector(".repeat__cell_type_switcher"),this.$repeatWrap=this.$el.querySelector(".repeat"),this.$repeatDay=this.$el.querySelectorAll(".repeat__item"),this.$signalDescBlock.addEventListener("touchstart",t.onEdit.bind(this)),this.$signalDelete.addEventListener("touchstart",t.onRemove.bind(this)),this.$signalSwitcher.addEventListener("touchstart",t.onChangeState.bind(this)),this.$repeatSwitcher.addEventListener("touchstart",t.onRepeatState.bind(this));var e=!0,i=!1,n=void 0;try{for(var a,r=this.$repeatDay[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var s=a.value;s.addEventListener("touchstart",t.onRepeatDay.bind(this))}}catch(l){i=!0,n=l}finally{try{!e&&r["return"]&&r["return"]()}finally{if(i)throw n}}var o=!0,d=!1,u=void 0;try{for(var c,v=this.$signalChar[Symbol.iterator]();!(o=(c=v.next()).done);o=!0){var h=c.value;this.currentInputTime.push(h.getAttribute("data-value")),h.addEventListener("touchstart",t.onCharClick.bind(this))}}catch(l){d=!0,u=l}finally{try{!o&&v["return"]&&v["return"]()}finally{if(d)throw u}}var f=!0,y=!1,_=void 0;try{for(var p,m=this.$keyboardNum[Symbol.iterator]();!(f=(p=m.next()).done);f=!0){var g=p.value;g.addEventListener("touchstart",t.onKeyClick.bind(this))}}catch(l){y=!0,_=l}finally{try{!f&&m["return"]&&m["return"]()}finally{if(y)throw _}}this.model.repeat.length&&this.activeRepeat(),this.model.active&&this.on()}},{key:"on",value:function(){this.isActive=!0,this.$el.classList.add("on")}},{key:"off",value:function(){this.isActive=!1,this.$el.classList.remove("on")}},{key:"open",value:function(){this.isEdit=!0,this.$el.classList.add("edit"),this.on(),this.editTime(),this.updateKeys()}},{key:"close",value:function(){this.isEdit=!1,this.$el.classList.remove("edit"),this.currentChar.classList.remove("on")}},{key:"remove",value:function(){this.store.remove(this.id)}},{key:"save",value:function(){var t=this.currentInputTime.join("");this.model.active=this.isActive,this.model.hour=parseInt(t[0]+""+t[1]),this.model.minute=parseInt(t[2]+""+t[3]),this.store.set(this.model)}},{key:"activeRepeat",value:function(){this.isRepeat=!0,this.$repeatWrap.classList.add("repeat_active")}},{key:"disactiveRepeat",value:function(){this.isRepeat=!1,this.$repeatWrap.classList.remove("repeat_active"),this.$signalDescription.innerHTML="",this.model.repeat=[];var t=!0,e=!1,i=void 0;try{for(var n,a=this.$repeatDay[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var r=n.value;r.classList.remove("on")}}catch(s){e=!0,i=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(e)throw i}}}},{key:"disableKeys",value:function(t,e){var i=!0,n=!1,a=void 0;try{for(var r,s=this.$keyboardNum[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value,o=parseInt(l.getAttribute("data-value"));o>=t&&o<=e?l.classList.add("disable"):l.classList.remove("disable")}}catch(d){n=!0,a=d}finally{try{!i&&s["return"]&&s["return"]()}finally{if(n)throw a}}}},{key:"activeChar",value:function(){var t=arguments.length<=0||void 0===arguments[0]||arguments[0],e=!0,i=!1,n=void 0;try{for(var a,r=this.$signalChar[Symbol.iterator]();!(e=(a=r.next()).done);e=!0){var s=a.value;s.classList.remove("on")}}catch(l){i=!0,n=l}finally{try{!e&&r["return"]&&r["return"]()}finally{if(i)throw n}}t&&this.currentChar.classList.add("on")}},{key:"editTime",value:function(t,e){this.currentInputEditPosition=t||0,this.currentChar=this.$signalChar[this.currentInputEditPosition],this.activeChar(),e&&(this.currentInputTime[this.currentInputEditPosition]=e,this.currentChar.setAttribute("data-value",e),this.currentChar.innerHTML=e,this.save())}},{key:"updateKeys",value:function(){var t=this.currentInputTime;switch(this.currentInputEditPosition){case 0:this.disableKeys(3,9);break;case 1:2===parseInt(t[0])&&this.disableKeys(4,9),0===parseInt(t[0])&&this.disableKeys(!1);break;case 2:this.disableKeys(6,9);break;case 3:this.disableKeys(!1)}}},{key:"render",value:function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return t.open&&this.open(),this.$el}}],[{key:"onEdit",value:function(){this.isEdit?this.close():this.open()}},{key:"onRemove",value:function(){this.$el.remove(),this.remove()}},{key:"onChangeState",value:function(){this.isActive?this.off():this.on(),this.save()}},{key:"onRepeatState",value:function(){this.isRepeat?this.disactiveRepeat():this.activeRepeat()}},{key:"onRepeatDay",value:function(t){t.target.classList.toggle("on");var e=[],i=[],n=!0,a=!1,r=void 0;try{for(var s,l=this.$repeatDay[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var o=s.value,d=o.getAttribute("data-value");o.classList.contains("on")&&(e.push(d),i.push(o.innerHTML))}}catch(u){a=!0,r=u}finally{try{!n&&l["return"]&&l["return"]()}finally{if(a)throw r}}this.model.repeat=e,this.$signalDescription.innerHTML=i.join(", "),this.save()}},{key:"onCharClick",value:function(t){if(this.isEdit){var e=0,i=!0,n=!1,a=void 0;try{for(var r,s=this.$signalChar[Symbol.iterator]();!(i=(r=s.next()).done);i=!0){var l=r.value;l===t.target&&this.editTime(e),e++}}catch(o){n=!0,a=o}finally{try{!i&&s["return"]&&s["return"]()}finally{if(n)throw a}}this.updateKeys()}else this.open()}},{key:"onKeyClick",value:function(t){var e=t.target.getAttribute("data-value");if(this.isEdit&&!t.target.classList.contains("disable")){var i=this.currentChar.nextElementSibling;this.editTime(this.currentInputEditPosition,e),i?(this.currentInputEditPosition++,this.currentChar=i,this.updateKeys(),this.activeChar()):(this.activeChar(!1),this.isEdit=!1)}}}]),t}();e["default"]=u},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=(e.str=function(t){return'\n\t<div class="signal__header">\n\t\t<div class="signal__cell signal__cell_type_time">\n\t\t\t<div class="signal__time">\n\t\t\t\t'+i(t.hour,t.minute)+'\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="signal__cell signal__cell_type_description">\n\t\t\t<div class="signal__description">\n\t\t\t\t'+a(t.repeat,t.weekDays)+'\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="signal__cell signal__cell_type_delete">\n\t\t\t<div class="signal__delete"></div>\n\t\t</div>\n\t\t<div class="signal__cell signal__cell_type_switcher">\n\t\t\t<div class="signal__switcher"></div>\n\t\t</div>\n\t</div>\n\t<div class="signal__keyboard keyboard">\n\t\t<div class="keyboard__row">\n\t\t\t<div class="keyboard__num" data-value="1">1</div>\n\t\t\t<div class="keyboard__num" data-value="2">2</div>\n\t\t\t<div class="keyboard__num" data-value="3">3</div>\n\t\t\t<div class="keyboard__num" data-value="4">4</div>\n\t\t\t<div class="keyboard__num" data-value="5">5</div>\n\t\t</div>\n\t\t<div class="keyboard__row">\n\t\t\t<div class="keyboard__num" data-value="6">6</div>\n\t\t\t<div class="keyboard__num" data-value="7">7</div>\n\t\t\t<div class="keyboard__num" data-value="8">8</div>\n\t\t\t<div class="keyboard__num" data-value="9">9</div>\n\t\t\t<div class="keyboard__num" data-value="0">0</div>\n\t\t</div>\n\t</div>\n\t<div class="signal__repeat repeat">\n\t\t<div class="repeat__cell repeat__cell_type_switcher">\n\t\t\t<div class="repeat__switcher"></div>\n\t\t\t<div class="repeat__description">Повторять в другие дни</div>\n\t\t</div>\n\t\t<div class="repeat__cell repeat__cell_type_list">\n\t\t\t<div class="repeat__list">\n\t\t\t\t'+n(t.repeat,t.weekDays)+"\n\t\t\t</div>\n\t\t</div>\n\t</div>\n"},e.signalTime=function(t,e){var i="",n=""+t,a=""+e;1===n.length&&(n=0+n),1===a.length&&(a=0+a);for(var r=0;r<n.length;r++)i+='<div class="signal__char" data-value="'+n[r]+'">'+n[r]+"</div>";for(var s=0;s<a.length;s++)i+='<div class="signal__char" data-value="'+a[s]+'">'+a[s]+"</div>";return i}),n=e.repeatItems=function(t,e){var i="";return e.forEach(function(e,n){var a=n+1,r=t.indexOf(String(a))>-1?"on":"";i+='<div class="repeat__item '+r+'" data-value="'+a+'">'+e+"</div>"}),i},a=e.signalDescription=function(t,e){var i="";return t.length&&t.forEach(function(t){var n=t-1;i+=e[n]+", "}),i.slice(0,-2)}},function(t,e,i){"use strict";function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e["default"]=t,e}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(7),l=n(s),o=function(){function t(e,i){a(this,t),this.template=l.str,this.alarm=e;var n=document.createElement("div");n.className="quickadd",n.innerHTML=this.template(i),this.$el=n,this.initialize()}return r(t,[{key:"initialize",value:function(){this.$nowAdd=this.$el.querySelector(".quickadd__item_add-now"),this.$dateAdd=this.$el.querySelectorAll(".quickadd__item_add-date"),this.$timeAdd=this.$el.querySelectorAll(".quickadd__item_add-time"),this.$nowAdd.addEventListener("click",this.onAddNow.bind(this));var t=!0,e=!1,i=void 0;try{for(var n,a=this.$dateAdd[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var r=n.value;r.addEventListener("click",this.onAddDate.bind(this))}}catch(s){e=!0,i=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(e)throw i}}var l=!0,o=!1,d=void 0;try{for(var u,c=this.$timeAdd[Symbol.iterator]();!(l=(u=c.next()).done);l=!0){var v=u.value;v.addEventListener("click",this.onAddTime.bind(this))}}catch(s){o=!0,d=s}finally{try{!l&&c["return"]&&c["return"]()}finally{if(o)throw d}}}},{key:"addSignal",value:function(t,e){var i=new Date,n=t||i.getHours(),a=e||i.getMinutes();this.alarm.add(n,a)}},{key:"onAddNow",value:function(){this.addSignal()}},{key:"onAddDate",value:function(t){var e=t.currentTarget.getAttribute("data-hour"),i=t.currentTarget.getAttribute("data-minute");this.alarm.add(e,i)}},{key:"onAddTime",value:function(t){var e=new Date,i=t.currentTarget.getAttribute("data-minutes"),n=e.getTime()+60*i*1e3,a=new Date(n),r=a.getHours(),s=a.getMinutes();this.alarm.add(r,s)}},{key:"render",value:function(t){return this.$el}}]),t}();e["default"]=o},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.str=function(t){return'\n\t<div class="quickadd__item quickadd__item_add-now">\n\t\t<div class="label label_blue"> \n\t\t\t<div class="label__text">+</div>\n\t\t</div>\n\t</div>\n\t<div class="quickadd__item quickadd__item_add-date" data-hour="8" data-minute="0">\n\t\t<div class="label">\n\t\t\t<div class="label__text">8</div>\n\t\t\t<div class="label__sup">00</div>\n\t\t</div>\n\t</div>\n\t<div class="quickadd__item quickadd__item_add-date" data-hour="9" data-minute="0">\n\t\t<div class="label">\n\t\t\t<div class="label__text">9</div>\n\t\t\t<div class="label__sup">00</div>\n\t\t</div>\n\t</div>\n\t<div class="label__devider"></div>\n\t<div class="quickadd__item quickadd__item_add-time" data-minutes="30">\n\t\t<div class="label">\n\t\t\t<div class="label__text">30</div>\n\t\t\t<div class="label__sub">м</div>\n\t\t</div>\n\t</div>\n\t<div class="quickadd__item quickadd__item_add-time" data-minutes="60">\n\t\t<div class="label">\n\t\t\t<div class="label__text">1</div>\n\t\t\t<div class="label__sub">ч</div>\n\t\t</div>\n\t</div>\n\t<div class="quickadd__item quickadd__item_add-time" data-minutes="480">\n\t\t<div class="label">\n\t\t\t<div class="label__text">8</div>\n\t\t\t<div class="label__sub">ч</div>\n\t\t</div>\n\t</div>\n'}},function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=i(1),l=n(s),o=i(2),d=n(o),u=function(){function t(){a(this,t),this.bindEvents()}return r(t,[{key:"bindEvents",value:function(){document.addEventListener("deviceready",this.onDeviceReady,!1),window.addEventListener("error",this.onPageError)}},{key:"onDeviceReady",value:function(){var t=new d["default"](function(){new l["default"](t)})}},{key:"onPageError",value:function(t){confirm(t.message)&&location.reload()}}]),t}();new u}]);